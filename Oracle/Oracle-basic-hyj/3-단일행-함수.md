# 함수
## 함수의 종류
- 단일행 함수
- 복수행 함수

## 단일행 함수
### 1. 문자함수
```
INITCAP​
LOWER​
UPPER​
LENGTH​
LENGTHB​
CONCAT
SUBSTR​
SUBSTRB​
INSTR​
INSTRB​
LPAD​
RPAD​
LTRIM​
RTRIM​
REPLACE​
REGEXP_REPLACE​
REGEXP_INSTR​
REGEXP_SUBSTR​
REGEXP_LIKE​
REGEXP_COUNT​
```
```sql
select name, length(name), lengthb(name) from student; -- 한글은 3byte이다
select concat(name,id) from student; -- name || id랑 같다. ||이 간단하니까 더 많이 쓴다
select studno, name, jumin from student where substr(jumin,3,2)='10'; -- 10월인 사람
select studno, name, jumin from student where substr(jumin,7,1)='1' or substr(jumin,7,1)='3'; -- 남자만?
select tel, substr(tel, 1,instr(tel,')')-1) from student; -- 보통 instr, substr은 같이 쓰는 일이많다
select tel, substr(tel, instr(tel,')') + 1, instr(tel,'-') - instr(tel,')') - 1) from student; -- 전화번호 앞자리
select name, lpad(id,10,'*') from student; -- 공백(' ')은 가급적 사용하지 말자
select name, rpad(id,10,'*') from student;
select ltrim('***abc**','*') from dual; -- dual : 가상의 테이블(임의의 테이블)
select name, replace(jumin, substr(jumin, 7, 7), '*******') from student; -- 주민번호 뒷번호를 가림
select replace(name, substr(name, 2, 1), '*') from student; -- 이름 가운데 글자만 *표시
select name, tel, instr(tel, 3) from student where deptno1 = 101; -- 3이 아예없는 애들은 0 리턴. ArrayList에도 비슷한 메서드가 있었다
select name, tel, SUBSTR(tel,1,instr(tel, ')')-1) from student where deptno1 = 201;
select LPAD(ename,9,'123456789') from emp where deptno = 10;
select RPAD(ename,9, substr('123456789', length(ename) + 1,9)) from emp where deptno = 10;
select ename, REPLACE(ename,substr(ename, 2, 2),'--') REPLACE from emp where deptno = 20;
select ename, REPLACE(ename,substr(ename, 2, 2),'--') REPLACE from emp where deptno = 20;
```

### 2. 숫자 관련 함수
```
ROUND​ : 주어진 숫자를 반올림 한 후 출력함​
TRUNC​ : 주어진 숫자를 버림 한 후 출력함​
MOD​ : 주어진 숫자를 나누기 한 후 나머지 값 출력함
CEIL​ : 주어진 숫자와 가장 근접한 큰 정수 출력함​
FLOOR​ : 주어진 숫자와 가장 근접한 작은 정수 출력함​
POWER​ : 주어진 숫자1의 숫자2 승을 출력함​
```

### 3. 날짜 관련 함수
```
SYSDATE​ : 시스템의 현재 날짜와 시간​
MONTHS_BETWEEN​ : 두 날짜 사이의 개월 수
ADD_MONTHS​ : 주어진 날짜에 개월을 더함​
NEXT_DAY​ : 주어진 날짜를 기준으로 돌아오는 날짜 출력
LAST_DAY​ : 주어진 날짜가 속한 달의 마지막 날짜 출력​
ROUND​ : 주어진 날짜를 반올림​
TRUNC​ : 주어진 날짜를 버림​
```
```sql
select ename, round(MONTHS_BETWEEN(SYSDATE,hiredate),1) from emp;
select ename, round((sysdate-hiredate)/31,1) 입사개월수 from emp;
select sysdate, next_day(sysdate, '금') from dual;
select sysdate, last_day('12/02/10') from dual;
```

### 4. 형 변환 함수
```
CHAR(n)​ : 고정길이의 문자를 저장합니다. 최대값은 2000 bytes 입니다​
VARCHAR2(n)​ : 변하는 길이의 문자를 저장합니다. 최대값은 4000 bytes 입니다​
NUMBER(p,s)​ : 숫자 값을 저장합니다.p 는 전체 자리수로 1-38 자리까지 가능하고 s는 소수점 이하 자리수로 -84 ~ 127 자리까지 가능합니다.​
DATE​ : 총 7Byte로 BC 4712년 1월 1일부터 AD 9999년 12월 31일까지의 날짜를 저장할 수 있습니다.
LONG : 가변 길이의 문자를 저장하며 최대 2GB 까지 저장 할 수 있습니다​​
CLOB : 가변 길이의 문자를 저장하며 최대 4GB 까지 저장 할 수 있습니다​​
BLOB : 가변 길이의 바이너리 데이터를 최대 4GB 까지 저장 할 수 있습니다​​
RAW(n) : 원시 이진 데이터로 최대 2000 bytes 까지 저장할 수 있습니다​​
LONG RAW(n)​ : 원시 이진 데이터로 최대 2GB까지 저장할 수 있습니다​
BFILE : 외부 파일에 저장된 데이터로 최대 4GB 까지 저장 할 수 있습니다​​ : 잘안씀
```
우리가 쓸것 : `BLOB`, CHAR, `VARCHAR2`, `NUMBER`, `DATE`   
그리고 아주 큰 문자를 저장할때 LONG과 CLOB를 고려해볼수있다. 그리고 크기를 딱맞게 잡는것 좋지않다. 좀 넉넉하게. 
파일을 저장할 땐 두가지 방법을 쓴다. 경로만 db에 저장하고(varchar) 파일은 서버에 저장하든지, 아예 파일자체를 db에 저장하든지. 이제는 성능이 좋아져서 blob를 자주 쓴다.  
![image](https://user-images.githubusercontent.com/68311318/123259717-bf06b880-d52f-11eb-9abf-b7d1084cfc74.png)


```sql
select 2+'2' from dual;
select 2+to_number('2') from dual;
select to_char(2) + '2' from dual;
select to_char(2) || '2' from dual;
select MONTHS_BETWEEN(SYSDATE, '72/04/03') from dual;
select sysdate - to_date('72/04/03') from dual; 
select birthday, to_char(birthday, 'YYYY'), to_char(birthday, 'MM') from student;
select name, birthday from student where to_char(birthday, 'MM') = 2;
select name, birthday from student where to_char(birthday, 'MM') = '02';
select studno, name, birthday from student where to_char(birthday, 'MM') = 1;
select empno, ename, hiredate from emp where to_char(hiredate, 'MM') in (1,2,3);
select to_char(hiredate, 'YYYY-MM-DD:HH24:MI:SS') from emp;
select to_char(hiredate, 'YYYYMMDDHHMISS') from emp;
select to_char(1234567,'$99,999,999,999') from dual;
select to_char(1234567,'$00009999999,999') from dual;
select empno, ename, sal, comm, to_char(sal*12 + comm, '99,999') salary from emp where ename = 'ALLEN';
```
